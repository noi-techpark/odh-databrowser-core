function setAccessToken(n){localStorage.setItem("accessToken",n)}function getAccessToken(){return localStorage.getItem("accessToken")}function contains(n,t){for(var i=0;i<n.length;i++)if(n[i]===t)return!0;return!1}function getLanguageLocalBrowser(){var n=localStorage.getItem("Language"),t;return n==null&&(t=navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage,console.log(t),n=t.substring(0,2)),n}function setLanguageLocalBrowser(n,t){var i;return localStorage.setItem("Language",n),t&&(i=navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage,console.log(i),i=i.substring(0,2),localStorage.setItem("Language",i)),localStorage.getItem("Language")}var appfactory=angular.module("appfactory",[]),appconfig;appfactory.factory("authInterceptorService",["$q","$location",function(n){var t={},i=function(n){n.headers=n.headers||{};var t=getAccessToken();return t?n.headers.Authorization="Bearer "+t:console.log("anonymous"),n},r=function(t){return t.status===401&&console.log("not allowed"),n.reject(t)};return t.request=i,t.responseError=r,t}]);appfactory.factory("leafletmapsimple",["leafletData",function(n){var t=46.655781,i=11.4296877,r=16;return{preparemap:function(u,f,e,o){var s=null,h=[],v=angular.element("[ng-controller="+o+"]").scope(),y=!1,a=!1;if(u!=undefined&&$.each(u,function(n){contains(e,u[n].Gpstype)&&(t=u[n].Latitude,i=u[n].Longitude,h.push(u[n]),y=!0)}),f!=null&&f!=""){var c="",l="";$.each(f,function(n){f[n].Type=="detailed"&&(a=!0,gpstrackid=f[n].Id,f[n].GpxTrackUrl.startsWith("https://lcs.lts.it/downloads/gpx/")?(l="lts",c=f[n].GpxTrackUrl.replace("https://lcs.lts.it/downloads/gpx/",""),s="/api/Activity/Gpx/"+encodeURI(c)):f[n].GpxTrackUrl.startsWith("http://lcs.tourist.bz.it/downloads/gpx/")?(l="lts",c=f[n].GpxTrackUrl.replace("http://lcs.tourist.bz.it/downloads/gpx/",""),s="/api/Activity/Gpx/"+encodeURI(c)):f[n].GpxTrackUrl.startsWith("http://service.suedtirol.info/Gpx/")&&(l="smg",c=f[n].GpxTrackUrl.replace("http://service.suedtirol.info/Gpx/",""),s="/api/SmgPoiGpx/"+gpstrackid),console.log("gpstrack found "+s))})}console.log("centering to "+t+" "+i);angular.extend(v,{leafletcoords:{lat:t,lng:i,zoom:r}});L.Icon.Default.imagePath="../Content/images/";n.getMap().then(function(n){$.each(h,function(t){L.marker([h[t].Latitude,h[t].Longitude]).addTo(n).bindPopup(h[t].Gpstype).openPopup()});s!=null&&a&&(console.log("getting gps from "+s),new L.GPX(s,{async:!0,gpx_options:{parseElements:"track"},marker_options:{startIconUrl:"../Content/images/pin-icon-start.png",endIconUrl:"../Content/images/pin-icon-end.png",shadowUrl:"../Content/images/pin-shadow.png"}}).on("loaded",function(t){n.fitBounds(t.target.getBounds())}).addTo(n))})}}}]);appfactory.factory("languageFactory",function(){var n={};return n.setLanguage=function(n,t){return setLanguageLocalBrowser(n,t)},n.getLanguage=function(){return getLanguageLocalBrowser()},n});appconfig=angular.module("appconfig",["appfactory","ngRoute"]);appconfig.value("appconfig",{basePath:""});appconfig.config(function(n){n.interceptors.push("authInterceptorService")});